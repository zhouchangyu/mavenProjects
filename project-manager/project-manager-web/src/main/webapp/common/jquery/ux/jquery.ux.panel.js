(function($){var panelOpts={extendContainer:true,width:300,height:300,layout:"autolayout",layoutCfg:{},icon:"",tbar:[{id:"close"}],cls:"",left:0,containment:"parent",top:0,autoWidth:false,cmpCls:"jq-panel",renderTo:null,borderHeight:50,style:{},"float":false,tools:[],activeCls:"window-active",lazyContainer:false,autoHideBorders:false,autoHideToolbar:false,isMaximize:false,listeners:{resize:$.noop}};$(window).resize(function(){$.each(Tee.components,function(k,v){if(v.status&&v.status.fillCtn||v.status.maximize){v.maxEvt&&v.maxEvt()}})});Tee.createComponent("Panel",panelOpts,Tee.Component.prototype,{initComponent:function(){this.el.addClass("extend-container");if(typeof this.height==="string"&&/^[0-9]{1,}$/.test(this.height)){this.height*=1}if(typeof this.width==="string"&&/^[0-9]{1,}$/.test(this.width)){this.width*=1}this.doRender();if(Tee.browser.isIE6&&this["float"]){this.ie6Mask=$('<iframe border="0" frameborder="0" cellspacing="10" class="ie6mask" src="about:blank"></iframe>');var self=this;self.el.append(self.ie6Mask);setTimeout(function(){self.ie6Mask.css({height:self.el.innerHeight()-12,width:self.el.innerWidth()-12})},100)}},refresh:function(){this.status.container=false;Tee.Component.prototype.refresh.apply(this,arguments)},doRender:function(){var css={height:"auto"};if(!this.autoWidth){css.width=this.width}this.el.css(css);this.createHeader();this.createBody();this.lazyContainer||this.doContainer();this.createFooter();if(this.draggable){this.clickActive()}},doInitStatus:function(){if(this.autoHideBorders){this.setAutoHideBorders()}if(this.autoHideTools){this.setAutoHideTools()}if(this.isPin){this.pin();this.tools.pin&&this.tools.pin.hide()}else{this.tools.unpin&&this.tools.unpin.hide()}if(this.top||this.left||this.right||this.bottom){this.posCenter=false}if(this.posCenter){var ctn;if(!this.containment||this.containment=="parent"){ctn=(this.parentCmp||this.parentEl)?"parent":null}else{ctn=$(this.containment)}this.setPosCenter(ctn)}else{this.el.css({left:this.left,top:this.top,bottom:this.bottom,right:this.right})}if(!this.isFillCtn&&!this.isMaximize){this.tools.restore&&this.tools.restore.hide()}else{if(this.isFillCtn){this.tools.plus&&this.tools.plus.hide();this.maximize(this.containment)}else{if(this.isMaximize){this.tools.maximize&&this.tools.maximize.hide();this.maximize()}}}this.doDbclick()},doDbclick:function(){var self=this;if(this.tools.plus&&this.tools.restore){this.headerEl.dblclick(function(){if(self.status.maximize){return}if(self.status.fillCtn){self.restore();self.tools.restore&&self.tools.restore.hide();self.tools.plus&&self.tools.plus.show()}else{self.maximize(self.containment);self.tools.restore&&self.tools.restore.show();self.tools.plus&&self.tools.plus.hide()}})}else{if(this.tools.maximize){this.headerEl.dblclick(function(){if(self.status.maximize){self.restore()}else{self.maximize()}})}}},doDraggable:function(){if(this.draggable){if(typeof this.draggable=="boolean"){this.draggable={}}if(typeof this.draggable.containment==="undefined"){this.draggable.containment="body"}}Tee.Component.prototype.doDraggable.call(this)},clickActive:function(){this.status.clickActive=true;var self=this;this.el.mousedown(function(){self.active()})},doResizable:function(){var self=this;if(this.resizable){if(!this.modal){var mask=$(".draggable-mask");if(!mask.length){mask=$('<div class="draggable-mask"></div>');$("body").append(mask)}(typeof this.resizable==="object")||(this.resizable={});this.resizable.start=function(e,ui){mask.css({"z-index":self.zIndex});mask.show()}}this.resizable.alsoResize=this.resizable.alsoResize||this.contentEl;this.resizable.minWidth=this.resizable.minWidth||this.minWidth||200;this.resizable.minHeight=this.resizable.minHeight||this.minHeight||100;Tee.Component.prototype.doResizable.call(this);this.el.resizable("option",{stop:function(e,ui){self.contentEl.css({width:"100%"});self.height=self.contentEl.height();self.width=self.el.width();self.el.css({height:"auto"});if(!self.modal){$(".draggable-mask").hide()}}});this.el.css({position:"absolute"})}},setPosCenter:function(ctn){ctn=ctn||$("body");if(ctn=="parent"){ctn=this.getParentEl()}ctn=$(ctn);if(ctn[0]&&ctn[0].tagName=="BODY"){ctn=$("body")}Tee.Panel.lastLeft=Tee.Panel.lastLeft||0;Tee.Panel.lastTop=Tee.Panel.lastTop||0;var scrollTop=document.documentElement.scrollTop||document.body.scrollTop;this.top=(ctn.height()-this.el.height()-100)/2+scrollTop+(Tee.Panel.lastTop+=0);this.left=(ctn.width()-this.el.width())/2+(Tee.Panel.lastLeft+=0);this.top=this.top<0?0:this.top;var pos=ctn.position();this.top+=pos.top;this.left+=pos.left;this.el.css({top:this.top,left:this.left})},toggle:function(speed){this.el.toggleClass(this.cmpCls+"-collapsed");this.contentEl.toggle(speed)},createHeader:function(){this.headerEl=$('<div class="'+this.cmpCls+'-header"></div>');this.headerEl.addClass("drag-handle");this.initTools();var title=$("<span></span>");if(this.icon){var img=$("<img></img>");img.attr("src",this.icon);img.attr("align","absmiddle");this.headerEl.append(img)}else{if(this.iconCls){var div=$('<div style="float: left;"></div>');div.addClass(this.iconCls);this.headerEl.append(div)}}title.attr("class",this.cmpCls+"-header-text");title.append(this.title);this.headerEl.append(title);var tl=$('<div class="'+this.cmpCls+'-tl"></div>');var tr=$('<div class="'+this.cmpCls+'-tr"></div>');var tc=$('<div class="'+this.cmpCls+'-tc"></div>');tl.append(tr);tr.append(tc);tc.append(this.headerEl);this.el.append(tl)},createBody:function(){this.contentEl=$('<div class="'+this.cmpCls+'-content"></div>');this.contentEl.css({height:this.height});var mc=$('<div class="'+this.cmpCls+'-mc"></div>');var ml=$('<div class="'+this.cmpCls+'-ml"></div>');var mr=$('<div class="'+this.cmpCls+'-mr"></div>');this.el.append(ml.append(mr.append(mc)));mc.append(this.contentEl)},doContainer:function(reload){if(!this.status.container||reload){var t=this;this.container=new Tee.Container({renderTo:t.contentEl,items:t.items,url:t.url,html:t.html,loadCallback:t.loadCallback,iframeSrc:t.iframeSrc||t.src,layout:t.layout,param:t.param,layout:t.layout,owner:t,layoutCfg:t.layoutCfg,contentEl:t.content});Tee.compose(this,this.container);this.status.container=true}},createFooter:function(){var bl=$('<div class="'+this.cmpCls+'-bl"></div>');var br=$('<div class="'+this.cmpCls+'-br"></div>');var bc=$('<div class="'+this.cmpCls+'-bc"></div>');var bcP=$('<div class="'+this.cmpCls+'-pointer-bc"></div>');bl.append(br);br.append(bc);this.el.append(bl);this.pointerBc&&this.el.append(bcP)},maximize:function(ctn){var type=!!ctn?"fillCtn":"maximize";ctn=ctn||$("body");if(ctn=="parent"){ctn=this.parentEl}ctn=$(ctn);if(!this.status.fillCtn&&!this.status.maximize){if(this.status.initialized){this.left=this.el.position().left;this.top=this.el.position().top}this.replacer={};this.replacer.offset=this.el.offset();this.replacer.css={height:this.contentEl.css("height"),width:this.el.css("width"),position:this.el.css("position")}}this.drag&&this.drag.disable();this.resize&&this.resize.disable();if(type=="maximize"){this.layer="middle"}else{this.layer="lower"}!this.status.hidden&&this.active();this.maximize.height=ctn.height()-this.borderHeight||50;var css=ctn.position();var h;if(this.layout=="cardlayout"&&this.layoutCfg.tabs){h=this.maximize.height}else{h=this.maximize.height}if(this.animate&&!this.status.hidden){var self=this;this.contentEl.find(".jq-container-iframe").hide();this.el.animate({width:ctn.width(),left:css.left},"fast",function(){self.contentEl.animate({height:h},"fast");self.el.animate({top:css.top},"fast",function(){self.contentEl.find(".jq-container-iframe").show()})})}else{this.contentEl.height(h);css.width="100%";this.el.css(css)}this.status.fillCtn=this.status.maximize=false;this.status[type]=true},getCrtHeight:function(){if(this.status.fillCtn||this.status.maximize){return this.maximize.height}return this.height},restore:function(){this.status.fillCtn=this.status.maximize=false;if(this.replacer){this.el.css({height:"auto",position:this.replacer.css.position});if(this.animate&&!this.status.hidden){var self=this;this.contentEl.find(".jq-container-iframe").hide();this.el.animate({top:this.top},"fast");this.contentEl.animate({height:this.replacer.css.height},"fast",function(){self.el.animate({left:self.left,width:self.replacer.css.width},"fast",function(){self.contentEl.find(".jq-container-iframe").show()})})}else{this.contentEl.css({height:this.replacer.css.height});this.el.css({left:this.left,top:this.top,width:this.replacer.css.width})}(this.el.parent()[0]!=$(this.parentEl)[0])&&this.el.appendTo(this.parentEl)}this.drag&&this.drag.enable();this.drag&&this.resize.enable();this.active("lower")},maxEvt:function(){var ctn;if(this.status.fillCtn){var ctn;if(!this.containment||this.containment=="parent"){ctn=this.parentEl}else{ctn=$(this.containment)}}else{if(this.status.maximize){ctn=$("body")}else{return}}this.el.width(ctn.width());this.maximize.height=ctn.height()-this.borderHeight||50;this.contentEl.height(this.maximize.height)},minimize:function(){this.hide()},pin:function(){this.active("upper")},unpin:function(){this.active("lower")},autoLoad:function(){},getAbsContentHeight:function(){return this.contentEl.height()+"px"},getTitle:function(){return this.title||""},setTitle:function(title){this.title=title||"";this.headerEl.find("span").html(this.title)},setWidth:function(width){this.width=width;this.el.css({width:this.width})},setHeight:function(height){this.height=height;this.contentEl.css({height:this.height})},scrollIn:function(speed,callback){var top=(this.status.fillCtn||this.status.maximize)?0:this.top;this.el.css({top:(document.documentElement||document.body).clientHeight+"px"});this.el.show();this.el.animate({top:top},speed||"slow",function(){callback&&callback()})},scrollOut:function(speed,callback){var self=this;var top=(this.status.fillCtn||this.status.maximize)?0:this.top;this.el.animate({top:(document.documentElement||document.body).clientHeight+"px"},speed||"slow",function(){self.el.hide();self.el.css({top:top});callback&&callback()})},collapse:function(speed,callback){var self=this;var top=this.getPosY();var height=this.getCrtHeight();this.el.stop().animate({top:parseInt(top+this.getCrtHeight())/2},speed);this.contentEl.stop().animate({height:0},speed,function(){self.el.css({display:"none"});self.contentEl.css({height:height});self.el.css({top:top});callback&&callback()});this.contentEl.find(".jq-container-iframe").hide()},expand:function(speed,callback){var self=this;var height=this.getCrtHeight();this.contentEl.css({height:0});this.el.show();var top=this.getPosY();this.el.css({top:top+parseInt(this.getCrtHeight())/2});this.el.stop().animate({top:top},speed,function(){});this.contentEl.stop().animate({height:height},speed,function(){self.doContainer();self.contentEl.find(".jq-container-iframe").show();callback&&callback()})},close:function(speed){var self=this;if(this.container&&this.container.iframeDom){var button=document.getElementById("buttonId");function unload(){setTimeout(function(){self.hide(speed,function(){self.destroy()})},0)}try{var conWin=this.container.iframeDom.contentWindow;if(conWin&&this.iframeUnload){}else{if(conWin.addEventListener){conWin.addEventListener("unload",unload,false)}else{if(conWin.attachEvent){conWin.attachEvent("onunload",unload)}else{this.hide(speed,function(){self.destroy()})}}}}catch(e){unload()}finally{}this.container.iframeDom.src="about:blank";this.iframeUnload=true}else{this.hide(speed,function(){self.destroy()})}},initTools:function(){var tools=this.tbar||[];var t=this;t.tools={};$.each(tools,function(i,e){if(Tee.Tools[e.id]){t.tools[e.id]={el:$('<a href="javascript:void(0)">&nbsp;</a>'),show:function(){this.el.show()},hide:function(){this.el.hide()},initTool:function(){t.headerEl.append(this.el);this.el.attr("class","jq-tool jq-tool-"+e.id);this.el.attr("title",Tee.Tools[e.id].title);if(e.hidden){this.hide()}this.el.bind("click",function(){if(!e.preventDefault){Tee.Tools[e.id].defaultHandler(e,t.tools[e.id].el,t,e.params)}if(e.handler){e.handler(e,t.tools[e.id].el,t,e.params)}return false})}};t.tools[e.id].initTool()}})},active:function(layer){this.layer=layer||this.layer;this.zIndex=Tee.topZIndex(this.layer);this.el.css({"z-index":this.zIndex});this.addClass(this.activeCls);this.status.hidden&&this.show()},deactive:function(){this.removeClass(this.activeCls)},hide:function(speed,callback){if(this.status.hidden){callback&&callback();return}var self=this;this.trayBtn&&this.trayBtn.disable();this.hideEffect(speed,function(){self.trayBtn&&self.trayBtn.enable();callback&&callback()});this.status.hidden=true},show:function(speed,callback){if(this.status.hidden){this.status.hidden=false;var self=this;this.trayBtn&&this.trayBtn.disable();this.showEffect(speed,function(){self.trayBtn&&self.trayBtn.enable();callback&&callback()})}},setAutoHideTools:function(){var self=this;this.headerEl.hide();this.el.hover(function(){self.headerEl.show()},function(){self.headerEl.hide()})},setAutoHideBorders:function(){this.el.addClass("window-tsp");this.el.hover(function(){$(this).removeClass("window-tsp")},function(){$(this).addClass("window-tsp")})},destroy:function(){if(this.container&&this.container.iframeDom){this.container.iframeDom.src="about:blank"}Tee.Component.prototype.destroy.call(this)}})})(jQuery);