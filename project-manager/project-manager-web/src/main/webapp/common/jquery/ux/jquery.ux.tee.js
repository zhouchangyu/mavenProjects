(function($){window.Tee={version:"2.1",register:{},isTouchDevice:"ontouchstart" in window,fitTouchDevice:function(){function simMouseEvt(type,target,pos){var evt=document.createEvent("MouseEvents");evt.initMouseEvent(type,true,true,document,0,pos.screenX,pos.screenY,pos.clientX,pos.clientY,false,false,false,false,0,target);return target.dispatchEvent(evt)}document.addEventListener("touchstart",function(e){if(!simMouseEvt("mousedown",e.target,e.changedTouches[0])){e.preventDefault();setTimeout(function(){if(e.target instanceof HTMLElement&&!e.target.getAttribute("Teemovement")){simMouseEvt("click",e.target,e.changedTouches[0])}},300)}});document.addEventListener("touchmove",function(e){e.target instanceof HTMLElement&&e.target.setAttribute("Teemovement","move");simMouseEvt("mousemove",e.target,e.changedTouches[0])||e.preventDefault()});document.addEventListener("touchend",function(e){var timer;if(e.target instanceof HTMLElement){if(e.target.getAttribute("Teedbclick")){clearTimeout(timer);e.target.removeAttribute("Teedbclick");simMouseEvt("dblclick",e.target,e.changedTouches[0])}else{e.target.setAttribute("Teedbclick","dbclick");timer=setTimeout(function(){e.target.removeAttribute("Teedbclick")},1000)}e.target.removeAttribute("Teemovement")}simMouseEvt("mouseup",e.target,e.changedTouches[0])||e.preventDefault()})},console:{log:window.console&&window.console.log||$.noop,info:window.console&&window.console.info||$.noop,warn:window.console&&window.console.warn||$.noop,error:window.console&&window.console.error||$.noop,assert:window.console&&window.console.assert||$.noop,dir:window.console&&window.console.dir||$.noop,clear:window.console&&window.console.clear||$.noop,profile:window.console&&window.console.profile||$.noop,profileEnd:window.console&&window.console.profileEnd||$.noop},parseJson:function(text){try{return eval("("+text+")")}catch(e){return{}}},browser:{isIE6:$.browser.msie&&/^6./.test($.browser.version),isIE7:$.browser.msie&&/^7./.test($.browser.version)},fx:function(open){$.fx.off=!open},formatJson:function(t,o){if(!o||!t){return}var r={};for(var k in t){var v=t[k];if(v&&v instanceof RegExp){if(o[k]&&v.test(o[k])){o[k]&&(r[k]=o[k])}else{return}}else{if(v&&v instanceof Array){if(!o[k]){continue}r[k]=[];$.each(o[k],function(i,e){r[k].push(Tee.formatJson(t,e))});r[k]=$.grep(r[k],function(e,i){return !!e})}else{if(v&&typeof v==="object"){o[k]&&(r[k]=Tee.formatJson(v,o[k]))}else{if(v==="*"){r[k]=o[k]}else{if(v==="not"){}else{o[k]&&(r[k]=o[k])}}}}}}return r},components:{},layouts:{register:{}},getCmp:function(id){return Tee.components[id]},addCmp:function(id,cmp){if(typeof id=="string"||typeof id=="number"){Tee.components[id]=cmp}},removeCmp:function(id){delete Tee.components[id]},getAutoID:function(prefix){Tee.autoID=Tee.autoID||0;Tee.autoID++;return(prefix||"TeeAuto")+Tee.autoID},jsonToString:function(o){var self=this;switch(typeof(o)){case"string":return'"'+o.replace(/(["\\])/g,"\\$1")+'"';case"function":return o;case"array":return"["+o.map(self.jsonToString).join(",")+"]";case"object":if(o instanceof Array){var strArr=[];var len=o.length;for(var i=0;i<len;i++){strArr.push(self.jsonToString(o[i]))}return"["+strArr.join(",")+"]"}else{if(o==null){return"null"}else{var string=[];for(var k in o){string.push(self.jsonToString(k)+":"+self.jsonToString(o[k]))}return"{"+string.join(",")+"}"}}case"number":return o;case false:return o;default:return o}},addPros:function(el,pros){var el=$(el);if(!el[0]||!pros){return false}var tagName=el[0].tagName;var elPros={BODY:["style"],DIV:["style","onclick"],SPAN:["style"],A:["href","style","target","onclick"],IMG:["style","src"]};$.each(pros,function(k,v){if($.inArray(k,elPros[tagName]||[])>=0){el.attr(k,v)}})},compose:function(cmp,subcmp){var o={};subcmp.compose()&&$.each(subcmp.compose(),function(k,v){if(typeof v==="function"){o[k]=function(){v.apply(subcmp,arguments)}}});$.extend(cmp,o)},isCmp:function(o){return !!(Tee.register[o&&o.xtype]&&o.status&&o.render)},createComponent:function(){var type=arguments[0],opts=arguments[1]||{},i=2,length=arguments.length;if(length>0){if(typeof name==="string"){this[type]=function(cfg){cfg=cfg||{};cfg.status=cfg.status||{};$.extend(true,this,opts);$.extend(this,cfg);this.initialize();return(this.members&&this.members())||this};for(;i<length;i++){$.extend(this[type].prototype,arguments[i])}}var xtype=type.toLowerCase();this.register[xtype]=this[type];this[type].prototype.xtype=xtype}},packCmp:function(cfg){cfg=cfg||{};cfg.el=$(cfg.el||cfg.html||"<div></div>");cfg.cls&&cfg.el.addClass(cfg.cls);cfg.style&&cfg.el.css(cfg.style);cfg.renderTo&&cfg.el.appendTo(cfg.renderTo);return{el:cfg.el,render:function(el){if(el){cfg.el.appendTo(el)}}}},zIndex:1,maxZIndex:9999,topZIndex:function(layer){Tee.zIndex++;return{upper:Tee.zIndex+5000,middle:Tee.zIndex+3000,lower:Tee.zIndex+1000}[layer]||Tee.zIndex},error:function(type){if(type=="close"){Tee.error.originalEvent=Tee.error.originalEvent||window.onerror;window.onerror=function(e,url,line){Tee.console.error(url+"  "+line+"  "+e);return true}}else{window.onerror=Tee.error.originalEvent}}};Tee.createComponent("Component",null,{initialize:function(){this.status.initialized=false;this.el=$(this.el||"<div></div>");this.id=this.id||Tee.getAutoID(this.autoIdPrefix);this.el.attr("id",this.id);Tee.addCmp(this.id,this);this.doListeners();this.doLoader();this.renderTo&&this.render(this.renderTo);this.cls&&this.el.addClass(this.cls);this.parentCmp&&this.parentCmp.addItems(this);this.initComponent();this.style&&this.el.css(this.style);this.doDraggable();this.doResizable();this.doInitStatus();this.status.initialized=true},doInitStatus:function(){},initComponent:$.noop,reload:function(){this.doLoader();this.refresh()},refresh:function(){this.empty();this.initComponent()},doDraggable:function(){if(this.draggable){if(!this.modal){var mask=$(".draggable-mask");if(!mask.length){mask=$('<div class="draggable-mask"></div>');$("body").append(mask)}this.draggable.start=function(e,ui){mask.css({"z-index":self.zIndex});mask.show()}}this.el.draggable(this.draggable);var self=this;this.el.bind("dragstop",function(){self.left=self.el.css("left");self.top=self.el.css("top");if(!self.modal){mask.hide()}});this.drag={destroy:function(){self.el.draggable("destroy")},disable:function(){self.el.draggable("disable")},enable:function(){self.el.draggable("enable")},option:function(name,value){return self.el.draggable("option",name,value)}};this.status.draggable=true}},doResizable:function(){if(this.resizable){this.el.resizable(this.resizable);var self=this;this.resize={destroy:function(){self.el.resizable("destroy")},disable:function(){self.el.resizable("disable")},enable:function(){self.el.resizable("enable")},option:function(name,value){return self.el.resizable("option",name,value)}};this.status.resizable=true}},doListeners:function(){if(this.listeners){var self=this;$.each(this.listeners,function(k,v){if(typeof v==="function"){Tee.Event.add(self,"bind",k,false,v)}else{if(typeof v==="object"){$.each(v,function(key,value){Tee.Event.add(self,"bind",k,key,value)})}}})}},empty:function(){this.el.empty()},destroy:function(){if(this.items){var items=this.items.slice();$.each(items,function(i,e){e&&e.destroy&&e.destroy()})}if(this.parentCmp){this.parentCmp.removeItem(this,true)}this.el.empty();this.el.remove();Tee.removeCmp(this.id)},hide:function(speed,callback){if(this.status.hidden){return}this.hideEffect.call(this,speed,callback);this.status.hidden=true},hideEffect:function(speed,callback){this.el.hide(speed);callback&&callback()},addClass:function(){this.el.addClass.apply(this.el,arguments)},removeClass:function(){this.el.removeClass.apply(this.el,arguments)},changeStyle:function(cls){this.addClass(cls)},show:function(){if(this.status.hidden){this.status.hidden=false;this.showEffect.apply(this,arguments)}},showEffect:function(){this.el.show.apply(this.el,arguments)},setPosition:function(pos){this.el.offset(pos)},fadeIn:function(){this.el.fadeIn.apply(this.el,arguments)},fadeOut:function(speed){this.el.fadeOut.apply(this.el,arguments)},render:function(el){if(el){this.el.appendTo(el);this.parentEl=el}},getId:function(){return this.id},setId:function(id){Tee.removeCmp(this.id);this.id=id;Tee.addCmp(this.id,this)},getWidth:function(){return this.width},getHeight:function(){return this.height},getAbsHeight:function(){return this.el.height()+"px"},getAbsWidth:function(){return this.el.width()+"px"},getPosX:function(){return this.el.position().left},getPosY:function(){return this.el.position().top},setStyle:function(style){this.el.css(style)},doLoader:function(){if(!this.loader||typeof this.loader!=="object"){return}var o;this.loader.param={totalRecords:this.maxRecords||0};if(this.loader.xtype==="loader"){o=this.loader.load()}else{var loader=new Tee.Loader(this.loader);o=loader.load()}this.data=o&&o.data;this.pageInfo=o&&o.pageInfo},getParentEl:function(flag){if(flag){return this.el.parent()}return this.parentEl||this.el.parent()[0]?this.el.parent():$("body")},getEvtActor:function(){return this.evtActor||this.el},setEvtActor:function(e){this.evtActor=e},members:$.noop,compose:$.noop});Tee.Loader=function(cfg){var opts={url:"",dataType:"json",type:"POST",param:{},dataRender:null,success:null,async:false,error:null};$.extend(true,this,opts,cfg);this.initialize()};$.extend(Tee.Loader.prototype,{initialize:function(){},load:function(){var t=this;var dataType=this.dataType;if(this.dataType.toLowerCase()=="json"){dataType="text"}var data;$.ajax({type:t.type,url:t.url,async:t.async,dataType:dataType,data:t.param,success:function(text){if(t.dataType.toLowerCase()=="json"){data=(t.dataRender||(function(data){if(data.rtState=="0"){data=data.rtData}else{console.info(data.rtMsrg)}return data}))(Tee.parseJson(text))}t.success&&t.success(data)},error:t.error});return{data:data}}});Tee.Plugins={};Tee.Event={add:function(cmp,type,name,moment,event,scope,params){if(cmp.getEvtActor&&((cmp[name]&&(moment==="before"||moment==="after"))||!moment)){var evtName=name+(moment||"");if(type=="bind"){cmp.getEvtActor().bind(evtName,{cmp:cmp,params:params},function(e){var args=Array.prototype.slice.call(arguments,0);args.push(e.data.cmp,e.data.params);event.apply(scope||cmp,args)})}else{if(type=="one"){cmp.getEvtActor().one(evtName,{cmp:cmp,params:params},function(e){event.call(scope||cmp,args)})}}if(moment==="before"||moment==="after"){if(cmp[name]&&!cmp[name].original){var tmp=cmp[name];cmp[name]=function(){cmp.getEvtActor().trigger(name+"before");cmp[name].original.apply(cmp,arguments);cmp.getEvtActor().trigger(name+"after")};cmp[name].original=tmp}}}},del:function(cmp,name,moment){if(cmp.getEvtActor&&(cmp[name]&&(moment==="before"||moment==="after")||!moment)){var evtName=name+(moment||"");cmp.getEvtActor().unbind(evtName)}}};Tee.Tools={toggle:{defaultHandler:function(event,toolEl,panel,params){panel.toggle()}},close:{title:"关闭",defaultHandler:function(event,toolEl,panel,params){panel.close()}},minimize:{title:"最小化",defaultHandler:function(event,toolEl,panel,params){panel.minimize()}},maximize:{title:"全屏最大化",defaultHandler:function(event,toolEl,panel,params){panel.tools.restore&&panel.tools.restore.show();panel.tools.plus&&panel.tools.plus.show();toolEl.hide();panel.maximize()}},restore:{title:"还原",defaultHandler:function(event,toolEl,panel,params){panel.tools.maximize&&panel.tools.maximize.show();panel.tools.plus&&panel.tools.plus.show();toolEl.hide();panel.restore()}},gear:{defaultHandler:function(event,toolEl,panel,params){}},pin:{title:"置顶",defaultHandler:function(event,toolEl,panel,params){panel.tools.pin&&panel.tools.pin.hide();panel.tools.unpin&&panel.tools.unpin.show();panel.pin()}},unpin:{title:"浮动",defaultHandler:function(event,toolEl,panel,params){panel.tools.pin&&panel.tools.pin.show();panel.tools.unpin&&panel.tools.unpin.hide();panel.unpin()}},right:{defaultHandler:function(event,toolEl,panel,params){}},left:{defaultHandler:function(event,toolEl,panel,params){}},up:{defaultHandler:function(event,toolEl,panel,params){}},down:{defaultHandler:function(event,toolEl,panel,params){}},refresh:{title:"刷新",defaultHandler:function(event,toolEl,panel,params){panel.refresh();panel.status.hidden&&panel.show()}},minus:{defaultHandler:function(event,toolEl,panel,params){}},plus:{title:"工作区最大化",defaultHandler:function(event,toolEl,panel,params){panel.tools.restore&&panel.tools.restore.show();panel.tools.maximize&&panel.tools.maximize.show();toolEl.hide();panel.maximize("parent")}},help:{defaultHandler:function(event,toolEl,panel,params){}},search:{defaultHandler:function(event,toolEl,panel,params){}},save:{defaultHandler:function(event,toolEl,panel,params){}},more:{title:"更多",defaultHandler:function(event,toolEl,panel,params){}}};if(Tee.isTouchDevice){Tee.fitTouchDevice()}function parseFeatures(features){if(!features){return}var cfg={};var pros=features.split(/[,;]/);for(var i=0;i<pros.length;i++){if(pros[i]){var kv=pros[i].split(/[=:]/);if(kv.length>1){var key={dialogheight:"height",dialogwidth:"width",height:"height",width:"width",resizable:"resizable"}[kv[0].toLowerCase()];if(key){cfg[key]=kv[1]}}}}return cfg}if(top==window&&Tee.isTouchDevice){window.showModalDialog=function(url,args,features){var win;var cfg={src:url,cls:"",layer:"upper",modal:true,draggable:{containment:false},listeners:{doContainer:{after:function(e,t){try{var i=t.container.iframeDom;var w=i.contentWindow;w.dialogArguments=args;var id=t.getId();i.onload=function(){w.dialogArguments=w.dialogArguments||args;try{var s=w.document.createElement("script");s.innerHTML="function close() {parent.Tee.getCmp('"+id+"').close();}";var head=w.document.getElementsByTagName("head").item(0);s.setAttribute("type","text/javascript");head.appendChild(s)}catch(e){w.close=function(){t.close()}}finally{}}}catch(e){}finally{}}}}};$.extend(true,cfg,parseFeatures(features));win=new Tee.Window(cfg);win.show()};window.open=function(url,name,features,replace){var self=this;var cfg={src:url,title:name,width:800,height:600,layer:"upper",draggable:{containment:false},resizable:{},listeners:{doContainer:{after:function(e,t){try{var i=t.container.iframeDom;var w=i.contentWindow;w.opener=self;var id=t.getId();i.onload=function(){try{w.opener=w.opener||self;var s=w.document.createElement("script");s.innerHTML="function close() {parent.Tee.getCmp('"+id+"').close();}";var head=w.document.getElementsByTagName("head").item(0);s.setAttribute("type","text/javascript");head.appendChild(s)}catch(e){try{w.close=function(){t.close()}}catch(e){d.d;Tee.console.info(e)}finally{}}finally{}}}catch(e){}finally{}}}}};$.extend(true,cfg,parseFeatures(features));var win=new Tee.Window(cfg);win.show()}}else{if(Tee.isTouchDevice){window.showModalDialog=function(){top.Tee&&top.showModalDialog.apply(this,arguments)};window.open=function(){top.Tee&&top.open.apply(this,arguments)}}}})(jQuery);